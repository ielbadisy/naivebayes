<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>High Performance Implementation of the Naive Bayes Algorithm • naivebayes</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="High Performance Implementation of the Naive Bayes Algorithm">
<meta property="og:description" content="In this implementation of the Naive Bayes classifier following class conditional distributions are available: Bernoulli, Categorical, Gaussian, Poisson and KDE (Non-Parametric representation of the class conditional density estimated via Kernel Density Estimation).">
<meta property="og:image" content="/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">naivebayes</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/majkamichal/naivebayes">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    

    
    
<!-- README.md is generated from README.Rmd. Please edit that file -->
<div id="naivebayes" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#naivebayes" class="anchor"></a>naivebayes <img src="reference/figures/logo.png" align="right">
</h1></div>

<div id="overview" class="section level2">
<h2 class="hasAnchor">
<a href="#overview" class="anchor"></a>1. Overview</h2>
<p>The <code>naivebayes</code> package provides an efficient implementation of the popular Naïve Bayes classifier in <code>R</code>. It was developed and is now maintained based on three principles: it should be efficient, user friendly and written in <code>Base R</code>. The last implies no dependencies, however, it neither denies nor interferes with being efficient as many functions from the <code>Base R</code> distribution use highly efficient routines programmed in lower level languages, such as <code>C</code> or <code>FORTRAN</code>. In fact, the <code>naivebayes</code> package utilizes only such functions for resource-intensive calculations.</p>
<p>The general function <code><a href="reference/naive_bayes.html">naive_bayes()</a></code> detects the class of each feature in the dataset and, depending on the user choices, assumes possibly different distribution for each feature. It currently supports following class conditional distributions:</p>
<ul>
<li>categorical distribution for discrete features</li>
<li>Poisson distribution for non-negative integers</li>
<li>Gaussian distribution for continuous features</li>
<li>non-parametrically estimated densities via Kernel Density Estimation for continuous features</li>
</ul>
<p>In addition to that specialized functions are available which implement:</p>
<ul>
<li>Bernoulli Naive Bayes via <code><a href="reference/bernoulli_naive_bayes.html">bernoulli_naive_bayes()</a></code>
</li>
<li>Multinomial Naive Bayes via <code><a href="reference/multinomial_naive_bayes.html">multinomial_naive_bayes()</a></code>
</li>
<li>Poisson Naive Bayes via <code><a href="reference/poisson_naive_bayes.html">poisson_naive_bayes()</a></code>
</li>
<li>Gaussian Naive Bayes via <code><a href="reference/gaussian_naive_bayes.html">gaussian_naive_bayes()</a></code>
</li>
<li>Non-Parametric Naive Bayes via <code><a href="reference/nonparametric_naive_bayes.html">nonparametric_naive_bayes()</a></code>
</li>
</ul>
<p>They are implemented based on the linear algebra operations which makes them efficient on the dense matrices. In close future sparse matrices will be supported in order to boost the performance on the sparse data. Also few helper functions are provided that are supposed to improve the user experience. The general <code><a href="reference/naive_bayes.html">naive_bayes()</a></code> function is also available through the excellent <code>Caret</code> package.</p>
<p>Extended documentation can be found on the website: <a href="https://majkamichal.github.io/naivebayes/" class="uri">https://majkamichal.github.io/naivebayes/</a></p>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>2. Installation</h2>
<p>Just like many other <code>R</code> packages, <code>naivebayes</code> can be installed from the <code>CRAN</code> repository by simply executing in the console the following line:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/install.packages">install.packages</a></span>(<span class="st">"naivebayes"</span>)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="co"># Or the the development version from GitHub:</span></a>
<a class="sourceLine" id="cb1-4" data-line-number="4">devtools<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/devtools/topics/reexports">install_github</a></span>(<span class="st">"majkamichal/naivebayes"</span>)</a></code></pre></div>
</div>
<div id="usage" class="section level2">
<h2 class="hasAnchor">
<a href="#usage" class="anchor"></a>3. Usage</h2>
<p>The <code>naivebayes</code> package provides a user friendly implementation of the Naïve Bayes algorithm via formula interlace and classical combination of the matrix/data.frame containing the features and a vector with the class labels. All functions can recognize missing values, give an informative warning and more importantly - they can handle them. In following the basic usage of the <code>naivebayes</code> package is demonstrated:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(naivebayes)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(iris)</a>
<a class="sourceLine" id="cb2-4" data-line-number="4">new &lt;-<span class="st"> </span>iris[<span class="op">-</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)]</a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="co"># Add one categorical and count variable</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb2-7" data-line-number="7">new<span class="op">$</span>Discrete &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sample">sample</a></span>(LETTERS[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>], <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/nrow">nrow</a></span>(new), <span class="ot">TRUE</span>) </a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb2-9" data-line-number="9">new<span class="op">$</span>Counts &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Poisson">rpois</a></span>(<span class="dv">50</span>, <span class="dv">1</span>), <span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Poisson">rpois</a></span>(<span class="dv">50</span>, <span class="dv">2</span>), <span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Poisson">rpois</a></span>(<span class="dv">50</span>, <span class="dv">10</span>)) </a>
<a class="sourceLine" id="cb2-10" data-line-number="10"></a>
<a class="sourceLine" id="cb2-11" data-line-number="11"><span class="co"># Formula interface</span></a>
<a class="sourceLine" id="cb2-12" data-line-number="12">nb &lt;-<span class="st"> </span><span class="kw"><a href="reference/naive_bayes.html">naive_bayes</a></span>(Species <span class="op">~</span><span class="st"> </span>., <span class="dt">usepoisson =</span> <span class="ot">TRUE</span>, <span class="dt">data =</span> new)</a>
<a class="sourceLine" id="cb2-13" data-line-number="13"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/summary">summary</a></span>(nb)</a>
<a class="sourceLine" id="cb2-14" data-line-number="14"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-15" data-line-number="15"><span class="co">#&gt; ================================ Naive Bayes ================================= </span></a>
<a class="sourceLine" id="cb2-16" data-line-number="16"><span class="co">#&gt;  </span></a>
<a class="sourceLine" id="cb2-17" data-line-number="17"><span class="co">#&gt; - Call: naive_bayes.formula(formula = Species ~ ., data = new, usepoisson = TRUE) </span></a>
<a class="sourceLine" id="cb2-18" data-line-number="18"><span class="co">#&gt; - Laplace: 0 </span></a>
<a class="sourceLine" id="cb2-19" data-line-number="19"><span class="co">#&gt; - Classes: 3 </span></a>
<a class="sourceLine" id="cb2-20" data-line-number="20"><span class="co">#&gt; - Samples: 150 </span></a>
<a class="sourceLine" id="cb2-21" data-line-number="21"><span class="co">#&gt; - Features: 3 </span></a>
<a class="sourceLine" id="cb2-22" data-line-number="22"><span class="co">#&gt; - Conditional distributions: </span></a>
<a class="sourceLine" id="cb2-23" data-line-number="23"><span class="co">#&gt;     - Categorical: 1</span></a>
<a class="sourceLine" id="cb2-24" data-line-number="24"><span class="co">#&gt;     - Poisson: 1</span></a>
<a class="sourceLine" id="cb2-25" data-line-number="25"><span class="co">#&gt;     - Gaussian: 1</span></a>
<a class="sourceLine" id="cb2-26" data-line-number="26"><span class="co">#&gt; - Prior probabilities: </span></a>
<a class="sourceLine" id="cb2-27" data-line-number="27"><span class="co">#&gt;     - setosa: 0.3333</span></a>
<a class="sourceLine" id="cb2-28" data-line-number="28"><span class="co">#&gt;     - versicolor: 0.3333</span></a>
<a class="sourceLine" id="cb2-29" data-line-number="29"><span class="co">#&gt;     - virginica: 0.3333</span></a>
<a class="sourceLine" id="cb2-30" data-line-number="30"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-31" data-line-number="31"><span class="co">#&gt; ------------------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb2-32" data-line-number="32"></a>
<a class="sourceLine" id="cb2-33" data-line-number="33"></a>
<a class="sourceLine" id="cb2-34" data-line-number="34"><span class="co"># Or equivalently matrix/data.frame and class vector</span></a>
<a class="sourceLine" id="cb2-35" data-line-number="35">df &lt;-<span class="st"> </span>new[<span class="op">-</span><span class="dv">2</span>]</a>
<a class="sourceLine" id="cb2-36" data-line-number="36">class_vec &lt;-<span class="st"> </span>new[[<span class="dv">2</span>]]</a>
<a class="sourceLine" id="cb2-37" data-line-number="37">nb2 &lt;-<span class="st"> </span><span class="kw"><a href="reference/naive_bayes.html">naive_bayes</a></span>(<span class="dt">x =</span> df, <span class="dt">y =</span> class_vec, <span class="dt">usepoisson =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb2-38" data-line-number="38">nb2</a>
<a class="sourceLine" id="cb2-39" data-line-number="39"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-40" data-line-number="40"><span class="co">#&gt; ================================ Naive Bayes ================================= </span></a>
<a class="sourceLine" id="cb2-41" data-line-number="41"><span class="co">#&gt;  </span></a>
<a class="sourceLine" id="cb2-42" data-line-number="42"><span class="co">#&gt;  Call: </span></a>
<a class="sourceLine" id="cb2-43" data-line-number="43"><span class="co">#&gt; naive_bayes.default(x = df, y = class_vec, usepoisson = TRUE)</span></a>
<a class="sourceLine" id="cb2-44" data-line-number="44"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-45" data-line-number="45"><span class="co">#&gt; ------------------------------------------------------------------------------ </span></a>
<a class="sourceLine" id="cb2-46" data-line-number="46"><span class="co">#&gt;  </span></a>
<a class="sourceLine" id="cb2-47" data-line-number="47"><span class="co">#&gt; Laplace smoothing: 0</span></a>
<a class="sourceLine" id="cb2-48" data-line-number="48"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-49" data-line-number="49"><span class="co">#&gt; ------------------------------------------------------------------------------ </span></a>
<a class="sourceLine" id="cb2-50" data-line-number="50"><span class="co">#&gt;  </span></a>
<a class="sourceLine" id="cb2-51" data-line-number="51"><span class="co">#&gt;  A priori probabilities: </span></a>
<a class="sourceLine" id="cb2-52" data-line-number="52"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-53" data-line-number="53"><span class="co">#&gt;     setosa versicolor  virginica </span></a>
<a class="sourceLine" id="cb2-54" data-line-number="54"><span class="co">#&gt;  0.3333333  0.3333333  0.3333333 </span></a>
<a class="sourceLine" id="cb2-55" data-line-number="55"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-56" data-line-number="56"><span class="co">#&gt; ------------------------------------------------------------------------------ </span></a>
<a class="sourceLine" id="cb2-57" data-line-number="57"><span class="co">#&gt;  </span></a>
<a class="sourceLine" id="cb2-58" data-line-number="58"><span class="co">#&gt;  Tables: </span></a>
<a class="sourceLine" id="cb2-59" data-line-number="59"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-60" data-line-number="60"><span class="co">#&gt; ------------------------------------------------------------------------------ </span></a>
<a class="sourceLine" id="cb2-61" data-line-number="61"><span class="co">#&gt;  ::: Petal.Width (Gaussian) </span></a>
<a class="sourceLine" id="cb2-62" data-line-number="62"><span class="co">#&gt; ------------------------------------------------------------------------------ </span></a>
<a class="sourceLine" id="cb2-63" data-line-number="63"><span class="co">#&gt;            </span></a>
<a class="sourceLine" id="cb2-64" data-line-number="64"><span class="co">#&gt; Petal.Width    setosa versicolor virginica</span></a>
<a class="sourceLine" id="cb2-65" data-line-number="65"><span class="co">#&gt;        mean 0.2460000  1.3260000 2.0260000</span></a>
<a class="sourceLine" id="cb2-66" data-line-number="66"><span class="co">#&gt;        sd   0.1053856  0.1977527 0.2746501</span></a>
<a class="sourceLine" id="cb2-67" data-line-number="67"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-68" data-line-number="68"><span class="co">#&gt; ------------------------------------------------------------------------------ </span></a>
<a class="sourceLine" id="cb2-69" data-line-number="69"><span class="co">#&gt;  ::: Discrete (Categorical) </span></a>
<a class="sourceLine" id="cb2-70" data-line-number="70"><span class="co">#&gt; ------------------------------------------------------------------------------ </span></a>
<a class="sourceLine" id="cb2-71" data-line-number="71"><span class="co">#&gt;         </span></a>
<a class="sourceLine" id="cb2-72" data-line-number="72"><span class="co">#&gt; Discrete setosa versicolor virginica</span></a>
<a class="sourceLine" id="cb2-73" data-line-number="73"><span class="co">#&gt;        A   0.24       0.30      0.30</span></a>
<a class="sourceLine" id="cb2-74" data-line-number="74"><span class="co">#&gt;        B   0.38       0.38      0.44</span></a>
<a class="sourceLine" id="cb2-75" data-line-number="75"><span class="co">#&gt;        C   0.38       0.32      0.26</span></a>
<a class="sourceLine" id="cb2-76" data-line-number="76"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-77" data-line-number="77"><span class="co">#&gt; ------------------------------------------------------------------------------ </span></a>
<a class="sourceLine" id="cb2-78" data-line-number="78"><span class="co">#&gt;  ::: Counts (Poisson) </span></a>
<a class="sourceLine" id="cb2-79" data-line-number="79"><span class="co">#&gt; ------------------------------------------------------------------------------ </span></a>
<a class="sourceLine" id="cb2-80" data-line-number="80"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-81" data-line-number="81"><span class="co">#&gt;        setosa versicolor virginica</span></a>
<a class="sourceLine" id="cb2-82" data-line-number="82"><span class="co">#&gt; lambda   1.08       1.98     10.16</span></a>
<a class="sourceLine" id="cb2-83" data-line-number="83"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-84" data-line-number="84"><span class="co">#&gt; ------------------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb2-85" data-line-number="85"></a>
<a class="sourceLine" id="cb2-86" data-line-number="86"><span class="co"># Visualize class conditional probability distributions</span></a>
<a class="sourceLine" id="cb2-87" data-line-number="87"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(nb, <span class="dt">which =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"Petal.Width"</span>, <span class="st">"Discrete"</span>),</a>
<a class="sourceLine" id="cb2-88" data-line-number="88">     <span class="dt">arg.cat =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">color =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/grDevices/topics/palettes">heat.colors</a></span>(<span class="dv">3</span>)))</a></code></pre></div>
<p><img src="reference/figures/example-1.png" width="700"><img src="reference/figures/example-2.png" width="700"></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"></a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="co"># Browse tables</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="kw"><a href="reference/tables.html">tables</a></span>(nb, <span class="dt">which =</span> <span class="st">"Discrete"</span>) <span class="co"># &lt;=&gt; nb$tables["Discrete"]</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="co">#&gt; ------------------------------------------------------------------------------ </span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="co">#&gt;  ::: Discrete (Categorical) </span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="co">#&gt; ------------------------------------------------------------------------------ </span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="co">#&gt;         </span></a>
<a class="sourceLine" id="cb3-9" data-line-number="9"><span class="co">#&gt; Discrete setosa versicolor virginica</span></a>
<a class="sourceLine" id="cb3-10" data-line-number="10"><span class="co">#&gt;        A   0.24       0.30      0.30</span></a>
<a class="sourceLine" id="cb3-11" data-line-number="11"><span class="co">#&gt;        B   0.38       0.38      0.44</span></a>
<a class="sourceLine" id="cb3-12" data-line-number="12"><span class="co">#&gt;        C   0.38       0.32      0.26</span></a>
<a class="sourceLine" id="cb3-13" data-line-number="13"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-14" data-line-number="14"><span class="co">#&gt; ------------------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb3-15" data-line-number="15"></a>
<a class="sourceLine" id="cb3-16" data-line-number="16"><span class="co"># Get name of conditional distributions for each feature</span></a>
<a class="sourceLine" id="cb3-17" data-line-number="17"><span class="kw"><a href="reference/get_cond_dist.html">get_cond_dist</a></span>(nb) <span class="co"># &lt;=&gt; attr(nb$tables, "cond_dist") </span></a>
<a class="sourceLine" id="cb3-18" data-line-number="18"><span class="co">#&gt;   Petal.Width      Discrete        Counts </span></a>
<a class="sourceLine" id="cb3-19" data-line-number="19"><span class="co">#&gt;    "Gaussian" "Categorical"     "Poisson"</span></a>
<a class="sourceLine" id="cb3-20" data-line-number="20"></a>
<a class="sourceLine" id="cb3-21" data-line-number="21"><span class="co"># data.frame("Dist" = get_cond_dist(nb))</span></a>
<a class="sourceLine" id="cb3-22" data-line-number="22"></a>
<a class="sourceLine" id="cb3-23" data-line-number="23"><span class="co"># Classification</span></a>
<a class="sourceLine" id="cb3-24" data-line-number="24"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/predict">predict</a></span>(nb))</a>
<a class="sourceLine" id="cb3-25" data-line-number="25"><span class="co">#&gt; [1] setosa setosa setosa setosa setosa setosa</span></a>
<a class="sourceLine" id="cb3-26" data-line-number="26"><span class="co">#&gt; Levels: setosa versicolor virginica</span></a>
<a class="sourceLine" id="cb3-27" data-line-number="27"></a>
<a class="sourceLine" id="cb3-28" data-line-number="28"><span class="co"># Posterior probabilities</span></a>
<a class="sourceLine" id="cb3-29" data-line-number="29"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/predict">predict</a></span>(nb, <span class="dt">type =</span> <span class="st">"prob"</span>))</a>
<a class="sourceLine" id="cb3-30" data-line-number="30"><span class="co">#&gt;         setosa   versicolor    virginica</span></a>
<a class="sourceLine" id="cb3-31" data-line-number="31"><span class="co">#&gt; [1,] 1.0000000 2.715527e-08 1.515451e-14</span></a>
<a class="sourceLine" id="cb3-32" data-line-number="32"><span class="co">#&gt; [2,] 1.0000000 3.982773e-08 1.320599e-13</span></a>
<a class="sourceLine" id="cb3-33" data-line-number="33"><span class="co">#&gt; [3,] 1.0000000 3.982773e-08 1.320599e-13</span></a>
<a class="sourceLine" id="cb3-34" data-line-number="34"><span class="co">#&gt; [4,] 0.9999999 6.148842e-08 7.341108e-13</span></a>
<a class="sourceLine" id="cb3-35" data-line-number="35"><span class="co">#&gt; [5,] 1.0000000 2.715527e-08 1.515451e-14</span></a>
<a class="sourceLine" id="cb3-36" data-line-number="36"><span class="co">#&gt; [6,] 0.9999691 3.090011e-05 1.885905e-10</span></a></code></pre></div>
<div id="specialized-naive-bayes" class="section level3">
<h3 class="hasAnchor">
<a href="#specialized-naive-bayes" class="anchor"></a>3.1 Specialized Naive Bayes</h3>
<div id="bernoulli-naive-bayes-bernoulli_naive_bayes" class="section level4">
<h4 class="hasAnchor">
<a href="#bernoulli-naive-bayes-bernoulli_naive_bayes" class="anchor"></a>3.1.1 Bernoulli Naive Bayes (“bernoulli_naive_bayes”)</h4>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co">### Simulate the data:</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb4-3" data-line-number="3">cols &lt;-<span class="st"> </span><span class="dv">10</span> ; rows &lt;-<span class="st"> </span><span class="dv">100</span> ; probs &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"0"</span> =<span class="st"> </span><span class="fl">0.4</span>, <span class="st">"1"</span> =<span class="st"> </span><span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb4-4" data-line-number="4">M &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sample">sample</a></span>(<span class="dv">0</span><span class="op">:</span><span class="dv">1</span>, rows <span class="op">*</span><span class="st"> </span>cols,  <span class="ot">TRUE</span>, probs), <span class="dt">nrow =</span> rows, <span class="dt">ncol =</span> cols)</a>
<a class="sourceLine" id="cb4-5" data-line-number="5">y &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">factor</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sample">sample</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste0</a></span>(<span class="st">"class"</span>, LETTERS[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]), rows, <span class="ot">TRUE</span>, <span class="dt">prob =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="fl">0.3</span>,<span class="fl">0.7</span>)))</a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">colnames</a></span>(M) &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste0</a></span>(<span class="st">"V"</span>, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq_len</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/nrow">ncol</a></span>(M)))</a>
<a class="sourceLine" id="cb4-7" data-line-number="7">laplace &lt;-<span class="st"> </span><span class="fl">0.5</span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="co">### Train the Bernoulli Naive Bayes</span></a>
<a class="sourceLine" id="cb4-10" data-line-number="10">bnb &lt;-<span class="st"> </span><span class="kw"><a href="reference/bernoulli_naive_bayes.html">bernoulli_naive_bayes</a></span>(<span class="dt">x =</span> M, <span class="dt">y =</span> y, <span class="dt">laplace =</span> laplace)</a>
<a class="sourceLine" id="cb4-11" data-line-number="11"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/predict">predict</a></span>(bnb, <span class="dt">newdata =</span> M, <span class="dt">type =</span> <span class="st">"prob"</span>))</a>
<a class="sourceLine" id="cb4-12" data-line-number="12"><span class="co">#&gt;         classA    classB</span></a>
<a class="sourceLine" id="cb4-13" data-line-number="13"><span class="co">#&gt; [1,] 0.2051196 0.7948804</span></a>
<a class="sourceLine" id="cb4-14" data-line-number="14"><span class="co">#&gt; [2,] 0.1598350 0.8401650</span></a>
<a class="sourceLine" id="cb4-15" data-line-number="15"><span class="co">#&gt; [3,] 0.2211967 0.7788033</span></a>
<a class="sourceLine" id="cb4-16" data-line-number="16"><span class="co">#&gt; [4,] 0.1998863 0.8001137</span></a>
<a class="sourceLine" id="cb4-17" data-line-number="17"><span class="co">#&gt; [5,] 0.2346913 0.7653087</span></a>
<a class="sourceLine" id="cb4-18" data-line-number="18"><span class="co">#&gt; [6,] 0.1312229 0.8687771</span></a>
<a class="sourceLine" id="cb4-19" data-line-number="19"></a>
<a class="sourceLine" id="cb4-20" data-line-number="20"></a>
<a class="sourceLine" id="cb4-21" data-line-number="21"><span class="co">###  Equivalent calculation with general naive_bayes function.</span></a>
<a class="sourceLine" id="cb4-22" data-line-number="22"><span class="co">###  (it is made sure that the columns are factors with the 0-1 levels)</span></a>
<a class="sourceLine" id="cb4-23" data-line-number="23"></a>
<a class="sourceLine" id="cb4-24" data-line-number="24">df &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/as.data.frame">as.data.frame</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/lapply">lapply</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/as.data.frame">as.data.frame</a></span>(M), factor, <span class="dt">levels =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>,<span class="dv">1</span>)))</a>
<a class="sourceLine" id="cb4-25" data-line-number="25"><span class="co"># sapply(df, class)</span></a>
<a class="sourceLine" id="cb4-26" data-line-number="26">nb &lt;-<span class="st"> </span><span class="kw"><a href="reference/naive_bayes.html">naive_bayes</a></span>(df, y, <span class="dt">laplace =</span> laplace)</a>
<a class="sourceLine" id="cb4-27" data-line-number="27"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/predict">predict</a></span>(nb, <span class="dt">type =</span> <span class="st">"prob"</span>))</a>
<a class="sourceLine" id="cb4-28" data-line-number="28"><span class="co">#&gt;         classA    classB</span></a>
<a class="sourceLine" id="cb4-29" data-line-number="29"><span class="co">#&gt; [1,] 0.2051196 0.7948804</span></a>
<a class="sourceLine" id="cb4-30" data-line-number="30"><span class="co">#&gt; [2,] 0.1598350 0.8401650</span></a>
<a class="sourceLine" id="cb4-31" data-line-number="31"><span class="co">#&gt; [3,] 0.2211967 0.7788033</span></a>
<a class="sourceLine" id="cb4-32" data-line-number="32"><span class="co">#&gt; [4,] 0.1998863 0.8001137</span></a>
<a class="sourceLine" id="cb4-33" data-line-number="33"><span class="co">#&gt; [5,] 0.2346913 0.7653087</span></a>
<a class="sourceLine" id="cb4-34" data-line-number="34"><span class="co">#&gt; [6,] 0.1312229 0.8687771</span></a>
<a class="sourceLine" id="cb4-35" data-line-number="35"></a>
<a class="sourceLine" id="cb4-36" data-line-number="36"></a>
<a class="sourceLine" id="cb4-37" data-line-number="37"><span class="co"># Obtain probability tables</span></a>
<a class="sourceLine" id="cb4-38" data-line-number="38"><span class="kw"><a href="reference/tables.html">tables</a></span>(bnb, <span class="dt">which =</span> <span class="st">"V1"</span>)</a>
<a class="sourceLine" id="cb4-39" data-line-number="39"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-40" data-line-number="40"><span class="co">#&gt; ------------------------------------------------------------------------------ </span></a>
<a class="sourceLine" id="cb4-41" data-line-number="41"><span class="co">#&gt;  ::: V1 (Bernoulli) </span></a>
<a class="sourceLine" id="cb4-42" data-line-number="42"><span class="co">#&gt; ------------------------------------------------------------------------------ </span></a>
<a class="sourceLine" id="cb4-43" data-line-number="43"><span class="co">#&gt;      classA    classB</span></a>
<a class="sourceLine" id="cb4-44" data-line-number="44"><span class="co">#&gt; 0 0.9137931 0.7876712</span></a>
<a class="sourceLine" id="cb4-45" data-line-number="45"><span class="co">#&gt; 1 0.0862069 0.2123288</span></a>
<a class="sourceLine" id="cb4-46" data-line-number="46"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-47" data-line-number="47"><span class="co">#&gt; ------------------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb4-48" data-line-number="48"><span class="kw"><a href="reference/tables.html">tables</a></span>(nb, <span class="st">"V1"</span>)</a>
<a class="sourceLine" id="cb4-49" data-line-number="49"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-50" data-line-number="50"><span class="co">#&gt; ------------------------------------------------------------------------------ </span></a>
<a class="sourceLine" id="cb4-51" data-line-number="51"><span class="co">#&gt;  ::: V1 (Bernoulli) </span></a>
<a class="sourceLine" id="cb4-52" data-line-number="52"><span class="co">#&gt; ------------------------------------------------------------------------------ </span></a>
<a class="sourceLine" id="cb4-53" data-line-number="53"><span class="co">#&gt;    </span></a>
<a class="sourceLine" id="cb4-54" data-line-number="54"><span class="co">#&gt; V1     classA    classB</span></a>
<a class="sourceLine" id="cb4-55" data-line-number="55"><span class="co">#&gt;   0 0.9137931 0.7876712</span></a>
<a class="sourceLine" id="cb4-56" data-line-number="56"><span class="co">#&gt;   1 0.0862069 0.2123288</span></a>
<a class="sourceLine" id="cb4-57" data-line-number="57"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-58" data-line-number="58"><span class="co">#&gt; ------------------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb4-59" data-line-number="59"></a>
<a class="sourceLine" id="cb4-60" data-line-number="60"><span class="co"># Visualise class conditional Bernoulli distributions</span></a>
<a class="sourceLine" id="cb4-61" data-line-number="61"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(bnb, <span class="dt">which =</span> <span class="st">"V1"</span>)</a></code></pre></div>
<p><img src="reference/figures/example_bernoulli_naive_bayes-1.png" width="700"></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(nb, <span class="st">"V1"</span>)</a></code></pre></div>
<p><img src="reference/figures/example_bernoulli_naive_bayes-2.png" width="700"></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"></a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="co"># Check the equivalence of the class conditional distributions</span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/all">all</a></span>(<span class="kw"><a href="reference/get_cond_dist.html">get_cond_dist</a></span>(bnb) <span class="op">==</span><span class="st"> </span><span class="kw"><a href="reference/get_cond_dist.html">get_cond_dist</a></span>(nb))</a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="co">#&gt; [1] TRUE</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"></a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="co"># # Coerce the Bernoulli probability tables to a data.frame</span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="co"># bernoulli_tables_to_df(bnb)</span></a></code></pre></div>
</div>
<div id="gaussian-naive-bayes-gaussian_naive_bayes" class="section level4">
<h4 class="hasAnchor">
<a href="#gaussian-naive-bayes-gaussian_naive_bayes" class="anchor"></a>3.1.1 Gaussian Naive Bayes (“gaussian_naive_bayes”)</h4>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="co">### Simulate the data:</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2">cols &lt;-<span class="st"> </span><span class="dv">4</span> ; rows &lt;-<span class="st"> </span><span class="dv">100</span> ; probs &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"0"</span> =<span class="st"> </span><span class="fl">0.4</span>, <span class="st">"1"</span> =<span class="st"> </span><span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb7-3" data-line-number="3">M &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(rows <span class="op">*</span><span class="st"> </span>cols), <span class="dt">nrow =</span> rows, <span class="dt">ncol =</span> cols)</a>
<a class="sourceLine" id="cb7-4" data-line-number="4">y &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">factor</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sample">sample</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste0</a></span>(<span class="st">"class"</span>, LETTERS[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]), rows, <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">colnames</a></span>(M) &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste0</a></span>(<span class="st">"V"</span>, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq_len</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/nrow">ncol</a></span>(M)))</a>
<a class="sourceLine" id="cb7-6" data-line-number="6"></a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="co">### Train the Gaussian Naive Bayes</span></a>
<a class="sourceLine" id="cb7-8" data-line-number="8">gnb &lt;-<span class="st"> </span><span class="kw"><a href="reference/gaussian_naive_bayes.html">gaussian_naive_bayes</a></span>(<span class="dt">x =</span> M, <span class="dt">y =</span> y)</a>
<a class="sourceLine" id="cb7-9" data-line-number="9"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/predict">predict</a></span>(gnb, <span class="dt">newdata =</span> M, <span class="dt">type =</span> <span class="st">"prob"</span>))</a>
<a class="sourceLine" id="cb7-10" data-line-number="10"><span class="co">#&gt;         classA    classB</span></a>
<a class="sourceLine" id="cb7-11" data-line-number="11"><span class="co">#&gt; [1,] 0.4858042 0.5141958</span></a>
<a class="sourceLine" id="cb7-12" data-line-number="12"><span class="co">#&gt; [2,] 0.4851806 0.5148194</span></a>
<a class="sourceLine" id="cb7-13" data-line-number="13"><span class="co">#&gt; [3,] 0.7706261 0.2293739</span></a>
<a class="sourceLine" id="cb7-14" data-line-number="14"><span class="co">#&gt; [4,] 0.6513155 0.3486845</span></a>
<a class="sourceLine" id="cb7-15" data-line-number="15"><span class="co">#&gt; [5,] 0.4770423 0.5229577</span></a>
<a class="sourceLine" id="cb7-16" data-line-number="16"><span class="co">#&gt; [6,] 0.8346050 0.1653950</span></a>
<a class="sourceLine" id="cb7-17" data-line-number="17"></a>
<a class="sourceLine" id="cb7-18" data-line-number="18"><span class="co">###  Equivalent calculation with general naive_bayes function.</span></a>
<a class="sourceLine" id="cb7-19" data-line-number="19">nb &lt;-<span class="st"> </span><span class="kw"><a href="reference/naive_bayes.html">naive_bayes</a></span>(M, y)</a>
<a class="sourceLine" id="cb7-20" data-line-number="20"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/predict">predict</a></span>(nb, <span class="dt">type =</span> <span class="st">"prob"</span>))</a>
<a class="sourceLine" id="cb7-21" data-line-number="21"><span class="co">#&gt;         classA    classB</span></a>
<a class="sourceLine" id="cb7-22" data-line-number="22"><span class="co">#&gt; [1,] 0.4858042 0.5141958</span></a>
<a class="sourceLine" id="cb7-23" data-line-number="23"><span class="co">#&gt; [2,] 0.4851806 0.5148194</span></a>
<a class="sourceLine" id="cb7-24" data-line-number="24"><span class="co">#&gt; [3,] 0.7706261 0.2293739</span></a>
<a class="sourceLine" id="cb7-25" data-line-number="25"><span class="co">#&gt; [4,] 0.6513155 0.3486845</span></a>
<a class="sourceLine" id="cb7-26" data-line-number="26"><span class="co">#&gt; [5,] 0.4770423 0.5229577</span></a>
<a class="sourceLine" id="cb7-27" data-line-number="27"><span class="co">#&gt; [6,] 0.8346050 0.1653950</span></a>
<a class="sourceLine" id="cb7-28" data-line-number="28"></a>
<a class="sourceLine" id="cb7-29" data-line-number="29"><span class="co"># Obtain probability tables</span></a>
<a class="sourceLine" id="cb7-30" data-line-number="30"><span class="kw"><a href="reference/tables.html">tables</a></span>(gnb, <span class="dt">which =</span> <span class="st">"V1"</span>)</a>
<a class="sourceLine" id="cb7-31" data-line-number="31"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-32" data-line-number="32"><span class="co">#&gt; ------------------------------------------------------------------------------ </span></a>
<a class="sourceLine" id="cb7-33" data-line-number="33"><span class="co">#&gt;  ::: V1 (Gaussian) </span></a>
<a class="sourceLine" id="cb7-34" data-line-number="34"><span class="co">#&gt; ------------------------------------------------------------------------------ </span></a>
<a class="sourceLine" id="cb7-35" data-line-number="35"><span class="co">#&gt;         classA      classB</span></a>
<a class="sourceLine" id="cb7-36" data-line-number="36"><span class="co">#&gt; mu -0.15263804 -0.01306092</span></a>
<a class="sourceLine" id="cb7-37" data-line-number="37"><span class="co">#&gt; sd  1.04955060  1.04174322</span></a>
<a class="sourceLine" id="cb7-38" data-line-number="38"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-39" data-line-number="39"><span class="co">#&gt; ------------------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb7-40" data-line-number="40"><span class="kw"><a href="reference/tables.html">tables</a></span>(nb, <span class="st">"V1"</span>)</a>
<a class="sourceLine" id="cb7-41" data-line-number="41"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-42" data-line-number="42"><span class="co">#&gt; ------------------------------------------------------------------------------ </span></a>
<a class="sourceLine" id="cb7-43" data-line-number="43"><span class="co">#&gt;  ::: V1 (Gaussian) </span></a>
<a class="sourceLine" id="cb7-44" data-line-number="44"><span class="co">#&gt; ------------------------------------------------------------------------------ </span></a>
<a class="sourceLine" id="cb7-45" data-line-number="45"><span class="co">#&gt;       </span></a>
<a class="sourceLine" id="cb7-46" data-line-number="46"><span class="co">#&gt; V1          classA      classB</span></a>
<a class="sourceLine" id="cb7-47" data-line-number="47"><span class="co">#&gt;   mean -0.15263804 -0.01306092</span></a>
<a class="sourceLine" id="cb7-48" data-line-number="48"><span class="co">#&gt;   sd    1.04955060  1.04174322</span></a>
<a class="sourceLine" id="cb7-49" data-line-number="49"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-50" data-line-number="50"><span class="co">#&gt; ------------------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb7-51" data-line-number="51"></a>
<a class="sourceLine" id="cb7-52" data-line-number="52"><span class="co"># Visualise class conditional Gaussian distributions</span></a>
<a class="sourceLine" id="cb7-53" data-line-number="53"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(gnb, <span class="dt">which =</span> <span class="st">"V1"</span>)</a></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-3-1.png" width="700"></p>
</div>
</div>
<div id="usage-with-caret-package-naive_bayes" class="section level3">
<h3 class="hasAnchor">
<a href="#usage-with-caret-package-naive_bayes" class="anchor"></a>3.2 Usage with Caret package (“naive_bayes”)</h3>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(caret, <span class="dt">quietly =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(naivebayes)</a>
<a class="sourceLine" id="cb8-3" data-line-number="3"></a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="co"># Train the Naive Bayes model with the Caret package</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5">naive_bayes_via_caret &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/caret/topics/train">train</a></span>(Species <span class="op">~</span><span class="st"> </span>., </a>
<a class="sourceLine" id="cb8-6" data-line-number="6">                               <span class="dt">data =</span> new, </a>
<a class="sourceLine" id="cb8-7" data-line-number="7">                               <span class="dt">method =</span> <span class="st">"naive_bayes"</span>, </a>
<a class="sourceLine" id="cb8-8" data-line-number="8">                               <span class="dt">usepoisson =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb8-9" data-line-number="9"></a>
<a class="sourceLine" id="cb8-10" data-line-number="10">naive_bayes_via_caret</a>
<a class="sourceLine" id="cb8-11" data-line-number="11"><span class="co">#&gt; Naive Bayes </span></a>
<a class="sourceLine" id="cb8-12" data-line-number="12"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-13" data-line-number="13"><span class="co">#&gt; 150 samples</span></a>
<a class="sourceLine" id="cb8-14" data-line-number="14"><span class="co">#&gt;   3 predictor</span></a>
<a class="sourceLine" id="cb8-15" data-line-number="15"><span class="co">#&gt;   3 classes: 'setosa', 'versicolor', 'virginica' </span></a>
<a class="sourceLine" id="cb8-16" data-line-number="16"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-17" data-line-number="17"><span class="co">#&gt; No pre-processing</span></a>
<a class="sourceLine" id="cb8-18" data-line-number="18"><span class="co">#&gt; Resampling: Bootstrapped (25 reps) </span></a>
<a class="sourceLine" id="cb8-19" data-line-number="19"><span class="co">#&gt; Summary of sample sizes: 150, 150, 150, 150, 150, 150, ... </span></a>
<a class="sourceLine" id="cb8-20" data-line-number="20"><span class="co">#&gt; Resampling results across tuning parameters:</span></a>
<a class="sourceLine" id="cb8-21" data-line-number="21"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-22" data-line-number="22"><span class="co">#&gt;   usekernel  Accuracy   Kappa    </span></a>
<a class="sourceLine" id="cb8-23" data-line-number="23"><span class="co">#&gt;   FALSE      0.9984157  0.9976174</span></a>
<a class="sourceLine" id="cb8-24" data-line-number="24"><span class="co">#&gt;    TRUE      0.9891468  0.9835235</span></a>
<a class="sourceLine" id="cb8-25" data-line-number="25"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-26" data-line-number="26"><span class="co">#&gt; Tuning parameter 'laplace' was held constant at a value of 0</span></a>
<a class="sourceLine" id="cb8-27" data-line-number="27"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-28" data-line-number="28"><span class="co">#&gt; Tuning parameter 'adjust' was held constant at a value of 1</span></a>
<a class="sourceLine" id="cb8-29" data-line-number="29"><span class="co">#&gt; Accuracy was used to select the optimal model using the largest value.</span></a>
<a class="sourceLine" id="cb8-30" data-line-number="30"><span class="co">#&gt; The final values used for the model were laplace = 0, usekernel =</span></a>
<a class="sourceLine" id="cb8-31" data-line-number="31"><span class="co">#&gt;  FALSE and adjust = 1.</span></a>
<a class="sourceLine" id="cb8-32" data-line-number="32"></a>
<a class="sourceLine" id="cb8-33" data-line-number="33"><span class="co"># Classification</span></a>
<a class="sourceLine" id="cb8-34" data-line-number="34"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/predict">predict</a></span>(naive_bayes_via_caret, <span class="dt">newdata =</span> new))</a>
<a class="sourceLine" id="cb8-35" data-line-number="35"><span class="co">#&gt; [1] setosa setosa setosa setosa setosa setosa</span></a>
<a class="sourceLine" id="cb8-36" data-line-number="36"><span class="co">#&gt; Levels: setosa versicolor virginica</span></a>
<a class="sourceLine" id="cb8-37" data-line-number="37"></a>
<a class="sourceLine" id="cb8-38" data-line-number="38"><span class="co"># Posterior probabilities</span></a>
<a class="sourceLine" id="cb8-39" data-line-number="39"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/predict">predict</a></span>(naive_bayes_via_caret, <span class="dt">newdata =</span> new, <span class="dt">type =</span> <span class="st">"prob"</span>))</a>
<a class="sourceLine" id="cb8-40" data-line-number="40"><span class="co">#&gt;      setosa   versicolor    virginica</span></a>
<a class="sourceLine" id="cb8-41" data-line-number="41"><span class="co">#&gt; 1 1.0000000 2.525461e-08 1.216783e-13</span></a>
<a class="sourceLine" id="cb8-42" data-line-number="42"><span class="co">#&gt; 2 1.0000000 3.165327e-08 2.590761e-13</span></a>
<a class="sourceLine" id="cb8-43" data-line-number="43"><span class="co">#&gt; 3 1.0000000 3.165327e-08 2.590761e-13</span></a>
<a class="sourceLine" id="cb8-44" data-line-number="44"><span class="co">#&gt; 4 0.9999999 5.285298e-08 4.820271e-13</span></a>
<a class="sourceLine" id="cb8-45" data-line-number="45"><span class="co">#&gt; 5 1.0000000 2.525461e-08 1.216783e-13</span></a>
<a class="sourceLine" id="cb8-46" data-line-number="46"><span class="co">#&gt; 6 0.9999734 2.656060e-05 1.238316e-10</span></a>
<a class="sourceLine" id="cb8-47" data-line-number="47"></a>
<a class="sourceLine" id="cb8-48" data-line-number="48"><span class="co">## Recover the naive_bayes object</span></a>
<a class="sourceLine" id="cb8-49" data-line-number="49">nb_object &lt;-<span class="st"> </span>naive_bayes_via_caret<span class="op">$</span>finalModel</a>
<a class="sourceLine" id="cb8-50" data-line-number="50"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/class">class</a></span>(nb_object)</a>
<a class="sourceLine" id="cb8-51" data-line-number="51"><span class="co">#&gt; [1] "naive_bayes"</span></a></code></pre></div>
<p>Define tuning grid, do resampling and find the “optimal” model:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"></a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="co"># Define tuning grid </span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3">nb_grid &lt;-<span class="st">   </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/expand.grid">expand.grid</a></span>(<span class="dt">usekernel =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>),</a>
<a class="sourceLine" id="cb9-4" data-line-number="4">                         <span class="dt">laplace =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>, <span class="fl">0.5</span>, <span class="dv">1</span>), </a>
<a class="sourceLine" id="cb9-5" data-line-number="5">                         <span class="dt">adjust =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="fl">0.75</span>, <span class="dv">1</span>, <span class="fl">1.25</span>, <span class="fl">1.5</span>))</a>
<a class="sourceLine" id="cb9-6" data-line-number="6"><span class="co"># Fit the Naive Bayes model </span></a>
<a class="sourceLine" id="cb9-7" data-line-number="7"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">2550</span>)</a>
<a class="sourceLine" id="cb9-8" data-line-number="8">naive_bayes_via_caret2 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/caret/topics/train">train</a></span>(Species <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> new, </a>
<a class="sourceLine" id="cb9-9" data-line-number="9">                               <span class="dt">method =</span> <span class="st">"naive_bayes"</span>,</a>
<a class="sourceLine" id="cb9-10" data-line-number="10">                               <span class="dt">usepoisson =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb9-11" data-line-number="11">                               <span class="dt">tuneGrid =</span> nb_grid)</a>
<a class="sourceLine" id="cb9-12" data-line-number="12"><span class="co"># Selected tuning parameters</span></a>
<a class="sourceLine" id="cb9-13" data-line-number="13">naive_bayes_via_caret2<span class="op">$</span>finalModel<span class="op">$</span>tuneValue</a>
<a class="sourceLine" id="cb9-14" data-line-number="14"><span class="co">#&gt;   laplace usekernel adjust</span></a>
<a class="sourceLine" id="cb9-15" data-line-number="15"><span class="co">#&gt; 1       0     FALSE   0.75</span></a>
<a class="sourceLine" id="cb9-16" data-line-number="16"></a>
<a class="sourceLine" id="cb9-17" data-line-number="17"><span class="co">## View the final naive_bayes model</span></a>
<a class="sourceLine" id="cb9-18" data-line-number="18"><span class="co"># naive_bayes_via_caret2$finalModel</span></a>
<a class="sourceLine" id="cb9-19" data-line-number="19"></a>
<a class="sourceLine" id="cb9-20" data-line-number="20"><span class="co"># Visualize the tuning process</span></a>
<a class="sourceLine" id="cb9-21" data-line-number="21"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(naive_bayes_via_caret2)</a></code></pre></div>
<p><img src="reference/figures/example_caret2-1.png" width="700"></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"></a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="co"># Perform classification </span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/predict">predict</a></span>(naive_bayes_via_caret2, <span class="dt">newdata =</span> new))</a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="co">#&gt; [1] setosa setosa setosa setosa setosa setosa</span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="co">#&gt; Levels: setosa versicolor virginica</span></a></code></pre></div>
</div>
<div id="usage-with-nproc-package-naive_bayes" class="section level3">
<h3 class="hasAnchor">
<a href="#usage-with-nproc-package-naive_bayes" class="anchor"></a>3.3 Usage with nproc package (“naive_bayes”)</h3>
<p>Please find more information about the <code>nproc</code> package under: <a href="https://cran.r-project.org/web/packages/nproc/" class="uri">https://cran.r-project.org/web/packages/nproc/</a></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(nproc)</a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(naivebayes)</a>
<a class="sourceLine" id="cb11-3" data-line-number="3"></a>
<a class="sourceLine" id="cb11-4" data-line-number="4"><span class="co"># Simulate data</span></a>
<a class="sourceLine" id="cb11-5" data-line-number="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">2550</span>)</a>
<a class="sourceLine" id="cb11-6" data-line-number="6">n &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb11-7" data-line-number="7">x &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(n <span class="op">*</span><span class="st"> </span><span class="dv">2</span>), n, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb11-8" data-line-number="8">c &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="dv">3</span> <span class="op">*</span><span class="st"> </span>x[ ,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb11-9" data-line-number="9">y &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Binomial">rbinom</a></span>(n, <span class="dv">1</span>, <span class="dv">1</span> <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Log">exp</a></span>(<span class="op">-</span>c)))</a>
<a class="sourceLine" id="cb11-10" data-line-number="10">xtest &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(n <span class="op">*</span><span class="st"> </span><span class="dv">2</span>), n, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb11-11" data-line-number="11">ctest &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="dv">3</span> <span class="op">*</span><span class="st"> </span>xtest[,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb11-12" data-line-number="12">ytest &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Binomial">rbinom</a></span>(n, <span class="dv">1</span>, <span class="dv">1</span> <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Log">exp</a></span>(<span class="op">-</span>ctest)))</a>
<a class="sourceLine" id="cb11-13" data-line-number="13"></a>
<a class="sourceLine" id="cb11-14" data-line-number="14"></a>
<a class="sourceLine" id="cb11-15" data-line-number="15"><span class="co"># Use Naive Bayes classifier and the default type I error control with alpha=0.05</span></a>
<a class="sourceLine" id="cb11-16" data-line-number="16">naive_bayes_via_nproc &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/nproc/topics/npc">npc</a></span>(x, y, <span class="dt">method =</span> <span class="st">"nb"</span>)</a>
<a class="sourceLine" id="cb11-17" data-line-number="17"></a>
<a class="sourceLine" id="cb11-18" data-line-number="18"><span class="co">## Recover the "naive_bayes" object</span></a>
<a class="sourceLine" id="cb11-19" data-line-number="19"><span class="co"># naive_bayes_via_nproc$fits[[1]]$fit</span></a>
<a class="sourceLine" id="cb11-20" data-line-number="20"></a>
<a class="sourceLine" id="cb11-21" data-line-number="21"><span class="co"># Classification</span></a>
<a class="sourceLine" id="cb11-22" data-line-number="22">nb_pred &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/predict">predict</a></span>(naive_bayes_via_nproc, xtest)</a>
<a class="sourceLine" id="cb11-23" data-line-number="23"></a>
<a class="sourceLine" id="cb11-24" data-line-number="24"><span class="co"># head(nb_pred$pred.label)</span></a>
<a class="sourceLine" id="cb11-25" data-line-number="25"></a>
<a class="sourceLine" id="cb11-26" data-line-number="26"><span class="co"># Obtain various measures</span></a>
<a class="sourceLine" id="cb11-27" data-line-number="27">accuracy &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/mean">mean</a></span>(nb_pred<span class="op">$</span>pred.label <span class="op">==</span><span class="st"> </span>ytest)</a>
<a class="sourceLine" id="cb11-28" data-line-number="28">ind0 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/which">which</a></span>(ytest <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb11-29" data-line-number="29">ind1 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/which">which</a></span>(ytest <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb11-30" data-line-number="30">typeI &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/mean">mean</a></span>(nb_pred<span class="op">$</span>pred.label[ind0] <span class="op">!=</span><span class="st"> </span>ytest[ind0]) <span class="co">#type I error on test set</span></a>
<a class="sourceLine" id="cb11-31" data-line-number="31">typeII &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/mean">mean</a></span>(nb_pred<span class="op">$</span>pred.label[ind1] <span class="op">!=</span><span class="st"> </span>ytest[ind1]) <span class="co">#type II error on test set</span></a>
<a class="sourceLine" id="cb11-32" data-line-number="32"></a>
<a class="sourceLine" id="cb11-33" data-line-number="33"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cat">cat</a></span>(<span class="st">" Overall Accuracy: "</span>,  accuracy,<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>, </a>
<a class="sourceLine" id="cb11-34" data-line-number="34">    <span class="st">"Type I error:     "</span>, typeI, <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>,</a>
<a class="sourceLine" id="cb11-35" data-line-number="35">    <span class="st">"Type II error:    "</span>, typeII, <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</a>
<a class="sourceLine" id="cb11-36" data-line-number="36"><span class="co">#&gt;  Overall Accuracy:  0.68 </span></a>
<a class="sourceLine" id="cb11-37" data-line-number="37"><span class="co">#&gt;  Type I error:      0.02072539 </span></a>
<a class="sourceLine" id="cb11-38" data-line-number="38"><span class="co">#&gt;  Type II error:     0.5081433</span></a></code></pre></div>
</div>
<div id="usage-with-superml-package-naive_bayes" class="section level3">
<h3 class="hasAnchor">
<a href="#usage-with-superml-package-naive_bayes" class="anchor"></a>3.4 Usage with superml package (“naive_bayes”)</h3>
<p>Please find more information about the <code>superml</code> package under: <a href="https://cran.r-project.org/web/packages/superml/" class="uri">https://cran.r-project.org/web/packages/superml/</a></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(superml)</a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(iris)</a>
<a class="sourceLine" id="cb12-3" data-line-number="3">naive_bayes_via_superml &lt;-<span class="st"> </span>NBTrainer<span class="op">$</span><span class="kw">new</span>()</a>
<a class="sourceLine" id="cb12-4" data-line-number="4">naive_bayes_via_superml<span class="op">$</span><span class="kw">fit</span>(iris, <span class="st">'Species'</span>)</a>
<a class="sourceLine" id="cb12-5" data-line-number="5"></a>
<a class="sourceLine" id="cb12-6" data-line-number="6"><span class="co">## Recover the naive_bayes object</span></a>
<a class="sourceLine" id="cb12-7" data-line-number="7"><span class="co"># naive_bayes_via_superml$model</span></a>
<a class="sourceLine" id="cb12-8" data-line-number="8"></a>
<a class="sourceLine" id="cb12-9" data-line-number="9"><span class="co"># Classification</span></a>
<a class="sourceLine" id="cb12-10" data-line-number="10"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(naive_bayes_via_superml<span class="op">$</span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/predict">predict</a></span>(iris))</a>
<a class="sourceLine" id="cb12-11" data-line-number="11"><span class="co">#&gt; Warning: predict.naive_bayes(): More features in the newdata are provided</span></a>
<a class="sourceLine" id="cb12-12" data-line-number="12"><span class="co">#&gt; as there are probability tables in the object. Calculation is performed</span></a>
<a class="sourceLine" id="cb12-13" data-line-number="13"><span class="co">#&gt; based on features to be found in the tables.</span></a>
<a class="sourceLine" id="cb12-14" data-line-number="14"><span class="co">#&gt; [1] setosa setosa setosa setosa setosa setosa</span></a>
<a class="sourceLine" id="cb12-15" data-line-number="15"><span class="co">#&gt; Levels: setosa versicolor virginica</span></a>
<a class="sourceLine" id="cb12-16" data-line-number="16"></a>
<a class="sourceLine" id="cb12-17" data-line-number="17"><span class="co"># Posterior probabilites</span></a>
<a class="sourceLine" id="cb12-18" data-line-number="18"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(naive_bayes_via_superml<span class="op">$</span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/predict">predict</a></span>(iris, <span class="dt">type =</span> <span class="st">"prob"</span>))</a>
<a class="sourceLine" id="cb12-19" data-line-number="19"><span class="co">#&gt; Warning: predict.naive_bayes(): More features in the newdata are provided</span></a>
<a class="sourceLine" id="cb12-20" data-line-number="20"><span class="co">#&gt; as there are probability tables in the object. Calculation is performed</span></a>
<a class="sourceLine" id="cb12-21" data-line-number="21"><span class="co">#&gt; based on features to be found in the tables.</span></a>
<a class="sourceLine" id="cb12-22" data-line-number="22"><span class="co">#&gt;      setosa   versicolor    virginica</span></a>
<a class="sourceLine" id="cb12-23" data-line-number="23"><span class="co">#&gt; [1,]      1 2.981309e-18 2.152373e-25</span></a>
<a class="sourceLine" id="cb12-24" data-line-number="24"><span class="co">#&gt; [2,]      1 3.169312e-17 6.938030e-25</span></a>
<a class="sourceLine" id="cb12-25" data-line-number="25"><span class="co">#&gt; [3,]      1 2.367113e-18 7.240956e-26</span></a>
<a class="sourceLine" id="cb12-26" data-line-number="26"><span class="co">#&gt; [4,]      1 3.069606e-17 8.690636e-25</span></a>
<a class="sourceLine" id="cb12-27" data-line-number="27"><span class="co">#&gt; [5,]      1 1.017337e-18 8.885794e-26</span></a>
<a class="sourceLine" id="cb12-28" data-line-number="28"><span class="co">#&gt; [6,]      1 2.717732e-14 4.344285e-21</span></a></code></pre></div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cloud.r-project.org/package=naivebayes">https://​cloud.r-project.org/​package=naivebayes</a>
</li>
<li>Browse source code at <br><a href="https://github.com/majkamichal/naivebayes">https://​github.com/​majkamichal/​naivebayes</a>
</li>
<li>Report a bug at <br><a href="http://github.com/majkamichal/naivebayes/issues">http://​github.com/​majkamichal/​naivebayes/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Michal Majka <br><small class="roles"> Maintainer </small>  </li>
</ul>
</div>

      <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://travis-ci.org/majkamichal/naivebayes"><img src="https://travis-ci.org/majkamichal/naivebayes.svg?branch=master" alt="Build Status"></a></li>
<li><a href="https://cran.r-project.org/package=naivebayes"><img src="http://www.r-pkg.org/badges/version/naivebayes" alt="CRAN_Status_Badge"></a></li>
<li><a href="http://cran.rstudio.com/web/packages/naivebayes/index.html"><img src="http://cranlogs.r-pkg.org/badges/naivebayes"></a></li>
<li><a href="https://saythanks.io/to/majkamichal"><img src="https://img.shields.io/badge/Say%20Thanks-!-1EAEDB.svg" alt="Say Thanks:)"></a></li>
</ul>
</div>
</div>

</div>


      <footer><div class="copyright">
  <p>Developed by Michal Majka.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
