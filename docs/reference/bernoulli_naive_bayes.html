<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Bernoulli Naive Bayes Classifier — bernoulli_naive_bayes • naivebayes</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Bernoulli Naive Bayes Classifier — bernoulli_naive_bayes" />

<meta property="og:description" content="bernoulli_naive_bayes is used to fit the Bernoulli Naive Bayes model in which all class conditional distributions are assumed to be Bernoulli and be independent." />

<meta property="og:image" content="https://majkamichal.github.io/naivebayes/logo.png" />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-87132983-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-87132983-2');
</script>

  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">naivebayes</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/naivebayes.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/caret, nproc and naivebayes.html">Caret, nproc and naivebayes</a>
    </li>
    <li>
      <a href="../articles/specialized_naive_bayes.html">Specialized Naive Bayes</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/majkamichal/naivebayes">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Bernoulli Naive Bayes Classifier</h1>
    
    <div class="hidden name"><code>bernoulli_naive_bayes.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p><code>bernoulli_naive_bayes</code> is used to fit the Bernoulli Naive Bayes model in which all class conditional distributions are assumed to be Bernoulli and be independent.</p>
    
    </div>

    <pre class="usage"><span class='fu'>bernoulli_naive_bayes</span>(<span class='no'>x</span>, <span class='no'>y</span>, <span class='kw'>prior</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>laplace</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>matrix with numeric 0-1 predictors.</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>class vector (character/factor/logical).</p></td>
    </tr>
    <tr>
      <th>prior</th>
      <td><p>vector with prior probabilities of the classes. If unspecified, the class proportions for the training set are used. If present, the probabilities should be specified in the order of the factor levels.</p></td>
    </tr>
    <tr>
      <th>laplace</th>
      <td><p>value used for Laplace smoothing (additive smoothing). Defaults to 0 (no Laplace smoothing).</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>not used.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>bernoulli_naive_bayes</code> returns an object of class "bernoulli_naive_bayes" which is a list with following components:</p>
<dt>data</dt><dd><p>list with two components: <code>x</code> (matrix with predictors) and <code>y</code> (class variable).</p></dd>
    <dt>levels</dt><dd><p>character vector with values of the class variable.</p></dd>
    <dt>laplace</dt><dd><p>amount of Laplace smoothing (additive smoothing).</p></dd>
    <dt>prob1</dt><dd><p>matrix with class conditional probabilities for the value 1. Based on this matrix full probability tables can be constructed. Please, see <code><a href='tables.html'>tables</a></code> and <code><a href='https://www.rdocumentation.org/packages/stats/topics/coef'>coef</a></code>.</p></dd>
    <dt>prior</dt><dd><p>numeric vector with prior probabilities.</p></dd>
    <dt>call</dt><dd><p>the call that produced this object.</p></dd>

    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    
    <p>This is a specialized version of the Naive Bayes classifier, in which all features take on numeric 0-1 values and class conditional probabilities are modelled with the Bernoulli distribution.</p>
<p>The Bernoulli Naive Bayes is available in both, <code>naive_bayes</code> and <code>bernoulli_naive_bayes</code>. The implementation of the specialized Naive Bayes provides more efficient performance though. The speedup comes from the restricting the data input to a numeric 0-1 matrix and performing the linear algebra as well as vectorized operations on it. In other words, the efficiency comes at cost of the flexibility.</p>
<p>The <code>bernoulli_naive_bayes</code> function is equivalent to the <code>naive_bayes</code> function when the numeric 0-1 matrix is coerced to, for instance, a 0-1 character matrix.</p>
<p>The missing values (NAs) are omited while constructing the probability tables. The NAs in the newdata in <code>predict.gaussian_naive_bayes</code> are not included into the calculation of posterior probabilities; and if present an informative warning is given.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='naive_bayes.html'>naive_bayes</a></code>, <code><a href='predict.bernoulli_naive_bayes.html'>predict.bernoulli_naive_bayes</a></code>, <code><a href='plot.bernoulli_naive_bayes.html'>plot.bernoulli_naive_bayes</a></code>, <code><a href='tables.html'>tables</a></code>, <code><a href='get_cond_dist.html'>get_cond_dist</a></code>, <code><a href='infix_class_prob.html'>%class%</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>### Simulate the data:</span>
<span class='no'>cols</span> <span class='kw'>&lt;-</span> <span class='fl'>10</span> ; <span class='no'>rows</span> <span class='kw'>&lt;-</span> <span class='fl'>100</span> ; <span class='no'>probs</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"0"</span> <span class='kw'>=</span> <span class='fl'>0.4</span>, <span class='st'>"1"</span> <span class='kw'>=</span> <span class='fl'>0.1</span>)
<span class='no'>M</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/matrix'>matrix</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/sample'>sample</a></span>(<span class='fl'>0</span>:<span class='fl'>1</span>, <span class='no'>rows</span> * <span class='no'>cols</span>,  <span class='fl'>TRUE</span>, <span class='no'>probs</span>), <span class='kw'>nrow</span> <span class='kw'>=</span> <span class='no'>rows</span>, <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='no'>cols</span>)
<span class='no'>y</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/factor'>factor</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/sample'>sample</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/paste'>paste0</a></span>(<span class='st'>"class"</span>, <span class='no'>LETTERS</span>[<span class='fl'>1</span>:<span class='fl'>2</span>]), <span class='no'>rows</span>, <span class='fl'>TRUE</span>, <span class='kw'>prob</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>0.3</span>,<span class='fl'>0.7</span>)))
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/colnames'>colnames</a></span>(<span class='no'>M</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/paste'>paste0</a></span>(<span class='st'>"V"</span>, <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/seq'>seq_len</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/nrow'>ncol</a></span>(<span class='no'>M</span>)))
<span class='no'>laplace</span> <span class='kw'>&lt;-</span> <span class='fl'>0.5</span>

<span class='co'>### Train the Bernoulli Naive Bayes</span>
<span class='no'>bnb</span> <span class='kw'>&lt;-</span> <span class='fu'>bernoulli_naive_bayes</span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='no'>M</span>, <span class='kw'>y</span> <span class='kw'>=</span> <span class='no'>y</span>, <span class='kw'>laplace</span> <span class='kw'>=</span> <span class='no'>laplace</span>)
<span class='no'>bnb</span></div><div class='output co'>#&gt; 
#&gt; ============================= Bernoulli Naive Bayes ============================= 
#&gt;  
#&gt;  Call: 
#&gt; bernoulli_naive_bayes(x = M, y = y, laplace = laplace)
#&gt; 
#&gt; --------------------------------------------------------------------------------- 
#&gt;  
#&gt; Laplace smoothing: 0.5
#&gt; 
#&gt; --------------------------------------------------------------------------------- 
#&gt;  
#&gt;  A priori probabilities: 
#&gt; classA classB 
#&gt;   0.36   0.64 
#&gt; 
#&gt; --------------------------------------------------------------------------------- 
#&gt;  
#&gt;  Tables: 
#&gt; 
#&gt; --------------------------------------------------------------------------------- 
#&gt;  ::: V1 (Bernoulli) 
#&gt; --------------------------------------------------------------------------------- 
#&gt;      classA    classB
#&gt; 0 0.8243243 0.8692308
#&gt; 1 0.1756757 0.1307692
#&gt; 
#&gt; --------------------------------------------------------------------------------- 
#&gt;  ::: V2 (Bernoulli) 
#&gt; --------------------------------------------------------------------------------- 
#&gt;      classA    classB
#&gt; 0 0.6081081 0.7461538
#&gt; 1 0.3918919 0.2538462
#&gt; 
#&gt; --------------------------------------------------------------------------------- 
#&gt;  ::: V3 (Bernoulli) 
#&gt; --------------------------------------------------------------------------------- 
#&gt;      classA    classB
#&gt; 0 0.8513514 0.7153846
#&gt; 1 0.1486486 0.2846154
#&gt; 
#&gt; --------------------------------------------------------------------------------- 
#&gt;  ::: V4 (Bernoulli) 
#&gt; --------------------------------------------------------------------------------- 
#&gt;      classA    classB
#&gt; 0 0.6351351 0.7615385
#&gt; 1 0.3648649 0.2384615
#&gt; 
#&gt; --------------------------------------------------------------------------------- 
#&gt;  ::: V5 (Bernoulli) 
#&gt; --------------------------------------------------------------------------------- 
#&gt;      classA    classB
#&gt; 0 0.7702703 0.8384615
#&gt; 1 0.2297297 0.1615385
#&gt; 
#&gt; ---------------------------------------------------------------------------------
#&gt; 
#&gt; # ... and 5 more tables
#&gt; 
#&gt; ---------------------------------------------------------------------------------
#&gt; </div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/head'>head</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/predict'>predict</a></span>(<span class='no'>bnb</span>, <span class='kw'>newdata</span> <span class='kw'>=</span> <span class='no'>M</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"prob"</span>))</div><div class='output co'>#&gt;         classA    classB
#&gt; [1,] 0.1536234 0.8463766
#&gt; [2,] 0.3689116 0.6310884
#&gt; [3,] 0.4345206 0.5654794
#&gt; [4,] 0.2376475 0.7623525
#&gt; [5,] 0.3954596 0.6045404
#&gt; [6,] 0.2230504 0.7769496</div><div class='input'>
<span class='co'>###  Equivalent calculation with general naive_bayes function.</span>
<span class='co'>###  (it is made sure that the columns are factors with the 0-1 levels)</span>

<span class='no'>df</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/as.data.frame'>as.data.frame</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/lapply'>lapply</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/as.data.frame'>as.data.frame</a></span>(<span class='no'>M</span>), <span class='no'>factor</span>, <span class='kw'>levels</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>)))
<span class='co'># sapply(df, class)</span>
<span class='no'>nb</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='naive_bayes.html'>naive_bayes</a></span>(<span class='no'>df</span>, <span class='no'>y</span>, <span class='kw'>laplace</span> <span class='kw'>=</span> <span class='no'>laplace</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/head'>head</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/predict'>predict</a></span>(<span class='no'>nb</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"prob"</span>))</div><div class='output co'>#&gt;         classA    classB
#&gt; [1,] 0.1536234 0.8463766
#&gt; [2,] 0.3689116 0.6310884
#&gt; [3,] 0.4345206 0.5654794
#&gt; [4,] 0.2376475 0.7623525
#&gt; [5,] 0.3954596 0.6045404
#&gt; [6,] 0.2230504 0.7769496</div><div class='input'>
<span class='co'># Obtain probability tables</span>
<span class='fu'><a href='tables.html'>tables</a></span>(<span class='no'>bnb</span>, <span class='kw'>which</span> <span class='kw'>=</span> <span class='st'>"V1"</span>)</div><div class='output co'>#&gt; 
#&gt; --------------------------------------------------------------------------------- 
#&gt;  ::: V1 (Bernoulli) 
#&gt; --------------------------------------------------------------------------------- 
#&gt;      classA    classB
#&gt; 0 0.8243243 0.8692308
#&gt; 1 0.1756757 0.1307692
#&gt; 
#&gt; ---------------------------------------------------------------------------------</div><div class='input'><span class='fu'><a href='tables.html'>tables</a></span>(<span class='no'>nb</span>, <span class='st'>"V1"</span>)</div><div class='output co'>#&gt; 
#&gt; --------------------------------------------------------------------------------- 
#&gt;  ::: V1 (Bernoulli) 
#&gt; --------------------------------------------------------------------------------- 
#&gt;    
#&gt; V1     classA    classB
#&gt;   0 0.8243243 0.8692308
#&gt;   1 0.1756757 0.1307692
#&gt; 
#&gt; ---------------------------------------------------------------------------------</div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/coef'>coef</a></span>(<span class='no'>bnb</span>)</div><div class='output co'>#&gt;      classA:0   classA:1  classB:0  classB:1
#&gt; V1  0.8243243 0.17567568 0.8692308 0.1307692
#&gt; V2  0.6081081 0.39189189 0.7461538 0.2538462
#&gt; V3  0.8513514 0.14864865 0.7153846 0.2846154
#&gt; V4  0.6351351 0.36486486 0.7615385 0.2384615
#&gt; V5  0.7702703 0.22972973 0.8384615 0.1615385
#&gt; V6  0.7432432 0.25675676 0.8230769 0.1769231
#&gt; V7  0.7432432 0.25675676 0.7923077 0.2076923
#&gt; V8  0.8513514 0.14864865 0.7307692 0.2692308
#&gt; V9  0.8513514 0.14864865 0.8384615 0.1615385
#&gt; V10 0.9324324 0.06756757 0.7461538 0.2538462</div><div class='input'>
<span class='co'># Visualise class conditional Bernoulli distributions</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='no'>bnb</span>, <span class='kw'>which</span> <span class='kw'>=</span> <span class='st'>"V1"</span>, <span class='kw'>prob</span> <span class='kw'>=</span> <span class='st'>"conditional"</span>)</div><div class='img'><img src='bernoulli_naive_bayes-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='no'>nb</span>, <span class='st'>"V1"</span>)</div><div class='img'><img src='bernoulli_naive_bayes-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Check the equivalence of the class conditional distributions</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/all'>all</a></span>(<span class='fu'><a href='get_cond_dist.html'>get_cond_dist</a></span>(<span class='no'>bnb</span>) <span class='kw'>==</span> <span class='fu'><a href='get_cond_dist.html'>get_cond_dist</a></span>(<span class='no'>nb</span>))</div><div class='output co'>#&gt; [1] TRUE</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Michal Majka, <a href='mailto:michalmajka@hotmail.com'>michalmajka@hotmail.com</a></p>
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Michal Majka.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

